#include "L1Trigger/UCT2015/interface/pileupmult_corrections.h"
#include "L1Trigger/UCT2015/interface/jetcorrections.h"
using namespace std;

double pumcorr(double pt, int ieta, unsigned int pum0) {
	double calib[]={ // no cuts at all Eta0-21 each line is eta, each number is pum0 #
		0.010441, 0.033569, 0.076139, 0.134926, 0.215131, 0.315947, 0.440691, 0.590090, 0.763479, 0.954096, 1.165015, 1.398629, 1.683007, 1.815972, 1.77203, 1.9169, 2.06177, 2.20664,
		0.019504, 0.079245, 0.161079, 0.259405, 0.375101, 0.509040, 0.658624, 0.834895, 1.037906, 1.269427, 1.527555, 1.806770, 2.122432, 2.454861, 2.32241, 2.50715, 2.69189, 2.87663,
		0.050236, 0.142153, 0.261321, 0.393866, 0.540058, 0.700833, 0.879533, 1.085475, 1.326028, 1.601942, 1.908101, 2.241114, 2.623016, 2.859375, 2.82869, 3.04762, 3.26656, 3.4855,
		0.039204, 0.081432, 0.139123, 0.201018, 0.266189, 0.341224, 0.427140, 0.532787, 0.659366, 0.811138, 0.982102, 1.170575, 1.376401, 1.699653, 1.51952, 1.63901, 1.7585, 1.87798,
		0.080575, 0.086574, 0.102992, 0.114889, 0.130342, 0.149101, 0.177773, 0.223754, 0.291260, 0.389749, 0.543918, 0.773737, 1.103058, 1.456597, 1.05908, 1.14673, 1.23438, 1.32202,
		0.062254, 0.072400, 0.089447, 0.095072, 0.103068, 0.114387, 0.129867, 0.153517, 0.186295, 0.230942, 0.288501, 0.385637, 0.454949, 0.593750, 0.475434, 0.510634, 0.545834, 0.581033,
		0.085894, 0.087120, 0.109594, 0.125375, 0.139899, 0.155169, 0.174657, 0.202974, 0.237287, 0.289819, 0.360799, 0.434404, 0.525327, 0.494792, 0.503818, 0.538393, 0.572967, 0.607542,
		0.057526, 0.115358, 0.138153, 0.153401, 0.170169, 0.187625, 0.211676, 0.243570, 0.290025, 0.346998, 0.425472, 0.520479, 0.587535, 0.751736, 0.642629, 0.688315, 0.734002, 0.779688,
		0.046887, 0.123209, 0.152373, 0.171349, 0.186956, 0.204511, 0.229616, 0.266009, 0.317784, 0.385385, 0.469888, 0.567544, 0.700280, 0.737847, 0.696978, 0.746484, 0.795989, 0.845495,
		0.066785, 0.139747, 0.184865, 0.202233, 0.225127, 0.244204, 0.272017, 0.312892, 0.373693, 0.454546, 0.555616, 0.699500, 0.809407, 0.871528, 0.823557, 0.88182, 0.940083, 0.998346,
		0.109338, 0.184232, 0.231926, 0.260245, 0.276835, 0.298845, 0.334375, 0.380241, 0.446422, 0.526246, 0.644314, 0.761724, 0.919001, 1.083333, 0.954682, 1.02048, 1.08627, 1.15207,
		0.106777, 0.192281, 0.230472, 0.244452, 0.264401, 0.285554, 0.319316, 0.364508, 0.427508, 0.510525, 0.617983, 0.753151, 0.871849, 1.060764, 0.92273, 0.986241, 1.04975, 1.11326,
		0.078211, 0.155514, 0.184269, 0.204553, 0.226632, 0.245843, 0.273920, 0.315276, 0.372498, 0.448208, 0.558120, 0.678564, 0.768674, 0.951389, 0.827739, 0.886088, 0.944437, 1.00279,
		0.083727, 0.129112, 0.151096, 0.170769, 0.188178, 0.201568, 0.225954, 0.259387, 0.307563, 0.373679, 0.455165, 0.585692, 0.738679, 0.762153, 0.705181, 0.755084, 0.804987, 0.854889,
		0.056541, 0.125523, 0.137377, 0.160796, 0.173807, 0.191319, 0.216251, 0.248073, 0.294409, 0.352219, 0.432466, 0.546585, 0.704248, 0.647569, 0.65019, 0.696051, 0.741913, 0.787775,
		0.055359, 0.088174, 0.111034, 0.129357, 0.138106, 0.155326, 0.176148, 0.203725, 0.241826, 0.295441, 0.360934, 0.447882, 0.563375, 0.670139, 0.572066, 0.613705, 0.655344, 0.696983,
		0.060875, 0.070815, 0.084721, 0.091203, 0.100025, 0.109039, 0.125200, 0.144570, 0.178759, 0.221135, 0.288795, 0.375060, 0.474090, 0.644097, 0.489745, 0.526774, 0.563803, 0.600832,
		0.063436, 0.087525, 0.104860, 0.116044, 0.128848, 0.145621, 0.173978, 0.215899, 0.279411, 0.376471, 0.519026, 0.729521, 0.949580, 1.305556, 0.960485, 1.03907, 1.11765, 1.19623,
		0.050433, 0.080045, 0.130324, 0.189256, 0.252757, 0.323573, 0.407174, 0.505875, 0.626692, 0.770640, 0.933436, 1.119468, 1.305789, 1.581597, 1.43348, 1.54578, 1.65809, 1.77039,
		0.075650, 0.146606, 0.257979, 0.393018, 0.537308, 0.697458, 0.874601, 1.080887, 1.318170, 1.591370, 1.891174, 2.246224, 2.555672, 3.062500, 2.86054, 3.08263, 3.30471, 3.5268,
		0.034870, 0.090329, 0.167785, 0.273728, 0.393035, 0.531421, 0.688272, 0.868013, 1.073915, 1.308847, 1.569478, 1.869793, 2.161648, 2.364583, 2.3389, 2.52318, 2.70745, 2.89173,
		0.013396, 0.038878, 0.082565, 0.147201, 0.233471, 0.341180, 0.471723, 0.626414, 0.801051, 0.997313, 1.212176, 1.463288, 1.711368, 1.961806, 1.85829, 2.00985, 2.16142, 2.31298,
	};  
	//==============================================
	/*	double calib[]={ //ave nonzero region ET
		0.646341, 0.635042, 0.628578, 0.638258, 0.658643, 0.689467, 0.738843, 0.809833, 0.911685, 1.044880, 1.216030, 1.423623, 1.694079, 1.828671, 0.000000, 0.000000, 0.000000, 0.000000, 
		0.596386, 0.684787, 0.705634, 0.730512, 0.771508, 0.828771, 0.904380, 1.011169, 1.154143, 1.339127, 1.565916, 1.826360, 2.133388, 2.463415, 0.000000, 0.000000, 0.000000, 0.000000, 
		0.700549, 0.770175, 0.797840, 0.838526, 0.902557, 0.985375, 1.094689, 1.236801, 1.424414, 1.660478, 1.939966, 2.256799, 2.629768, 2.859375, 0.000000, 0.000000, 0.000000, 0.000000,
		0.843220, 0.805738, 0.800553, 0.813449, 0.823846, 0.851729, 0.889262, 0.943298, 1.012701, 1.105401, 1.217654, 1.350776, 1.504977, 1.773551, 0.000000, 0.000000, 0.000000, 0.000000,
		3.408333, 2.464366, 1.978324, 1.681214, 1.484464, 1.385484, 1.321917, 1.318183, 1.332452, 1.362098, 1.447283, 1.599403, 1.817500, 2.076733, 0.000000, 0.000000, 0.000000, 0.000000,
		2.358209, 2.124128, 1.825559, 1.527771, 1.356579, 1.268476, 1.212559, 1.197163, 1.190750, 1.190567, 1.207327, 1.290047, 1.254990, 1.187500, 0.000000, 0.000000, 0.000000, 0.000000, 
		1.929204, 1.365963, 1.269717, 1.199765, 1.133848, 1.089524, 1.065419, 1.063230, 1.063094, 1.093813, 1.142419, 1.183340, 1.211901, 1.104651, 0.000000, 0.000000, 0.000000, 0.000000,
		1.258621, 1.431099, 1.285988, 1.177673, 1.105371, 1.060246, 1.043345, 1.038277, 1.058557, 1.074493, 1.124955, 1.184992, 1.133784, 1.370253, 0.000000, 0.000000, 0.000000, 0.000000, 
		1.214286, 1.611837, 1.434676, 1.315984, 1.221098, 1.153523, 1.127353, 1.121402, 1.139639, 1.164382, 1.206317, 1.249127, 1.332149, 1.287879, 0.000000, 0.000000, 0.000000, 0.000000, 
		1.202128, 1.469099, 1.422967, 1.290734, 1.231457, 1.172296, 1.142971, 1.147626, 1.175154, 1.218197, 1.276388, 1.385438, 1.395934, 1.364130, 0.000000, 0.000000, 0.000000, 0.000000, 
		0.987544, 1.216543, 1.219021, 1.182946, 1.128862, 1.096369, 1.107211, 1.123483, 1.163138, 1.204213, 1.291780, 1.348110, 1.426966, 1.625000, 0.000000, 0.000000, 0.000000, 0.000000, 
		1.220721, 1.378920, 1.300888, 1.196285, 1.135343, 1.102031, 1.104891, 1.121483, 1.154780, 1.203072, 1.268360, 1.350759, 1.398353, 1.483010, 0.000000, 0.000000, 0.000000, 0.000000, 
		1.195783, 1.493078, 1.371774, 1.258751, 1.197281, 1.153177, 1.131909, 1.136083, 1.155150, 1.190944, 1.268827, 1.337664, 1.340798, 1.593023, 0.000000, 0.000000, 0.000000, 0.000000, 
		2.168367, 1.702821, 1.479005, 1.331514, 1.237427, 1.151004, 1.124923, 1.109684, 1.122554, 1.147479, 1.182333, 1.294726, 1.394053, 1.354938, 0.000000, 0.000000, 0.000000, 0.000000, 
		1.176230, 1.442371, 1.218791, 1.164251, 1.082417, 1.039759, 1.029755, 1.028985, 1.046745, 1.069560, 1.125937, 1.216584, 1.357175, 1.078035, 0.000000, 0.000000, 0.000000, 0.000000, 
		1.824675, 1.448711, 1.346325, 1.264243, 1.144192, 1.107870, 1.088414, 1.079177, 1.091149, 1.121136, 1.153068, 1.220267, 1.306006, 1.349650, 0.000000, 0.000000, 0.000000, 0.000000, 
		2.710526, 2.105040, 1.876049, 1.586687, 1.430635, 1.303526, 1.258942, 1.215522, 1.220941, 1.212102, 1.267810, 1.330745, 1.390144, 1.572034, 0.000000, 0.000000, 0.000000, 0.000000, 
		3.354167, 2.564299, 2.127759, 1.722965, 1.515890, 1.375216, 1.330350, 1.313144, 1.323250, 1.363159, 1.445885, 1.562535, 1.654331, 1.807692, 0.000000, 0.000000, 0.000000, 0.000000, 
		1.185185, 0.820315, 0.794250, 0.803867, 0.822285, 0.845987, 0.881582, 0.929874, 0.994349, 1.079805, 1.184487, 1.313639, 1.459051, 1.674632, 0.000000, 0.000000, 0.000000, 0.000000, 
		0.984615, 0.792327, 0.796270, 0.844396, 0.906464, 0.990243, 1.096395, 1.239270, 1.423150, 1.653935, 1.926763, 2.265512, 2.562851, 3.062500, 0.000000, 0.000000, 0.000000, 0.000000, 
		0.893939, 0.704374, 0.709728, 0.743204, 0.782222, 0.844441, 0.926487, 1.037267, 1.185509, 1.376027, 1.606124, 1.887772, 2.167213, 2.364583, 0.000000, 0.000000, 0.000000, 0.000000, 
		0.739130, 0.635128, 0.632158, 0.641587, 0.664601, 0.699876, 0.753663, 0.830390, 0.936240, 1.078111, 1.255585, 1.483156, 1.721413, 1.968641, 0.000000, 0.000000, 0.000000, 0.000000,};
		*/

	/*double regionSF[]={ //SCale FActors only
	  1.99791, 1.81283,1.89704, 2.03066, 1.81838, 1.71022, 1.73484, 1.71653, 1.64612, 1.56876, 1.56972, 1.56943, 1.62457, 1.66522, 1.75548, 1.70387, 1.77016, 1.84068, 2.0703, 1.88396, 1.79853, 1.97311,};*/


       double region_SF[]={
                1.27997, 0, 10.0382,
                1.45051, 0, 6.49017,
                1.52978, 0, 7.53412,
                1.61689, 0, 10.1012,
                1.29395, 0, 18.7129,
                1.22278, 0, 23.6606,
                1.25293, 0, 24.4677,
                1.22861, 0, 25.2746,
                1.21071, 0, 23.4553,
                1.16955, 0, 22.6286,
                1.1838, 0, 20.9017,
                1.18977, 0, 21.1769,
                1.21333, 0, 22.1565,
                1.23575, 0, 23.0727,
                1.27147, 0, 24.363,
                1.22103, 0, 24.9567,
                1.22637, 0, 24.2517,
                1.30175, 0, 18.7771,
                1.61674, 0, 10.2858,
                1.53865, 0, 7.30213,
                1.42139, 0, 6.72587,
                1.26112, 0, 10.0601,};

	double alpha = region_SF[3*ieta + 0];
	double gamma = (region_SF[3*ieta + 2])/9;
	//==============================================

	int pumbin = (int) pum0/22;

	double pum0AveEt = calib[ieta*18 + pumbin];

	double pum0pt =  (pt- pum0AveEt); 

	double corrpum0pt = pum0pt*alpha + gamma;

	if (corrpum0pt <0) {corrpum0pt=0;} 

	return corrpum0pt;

}


